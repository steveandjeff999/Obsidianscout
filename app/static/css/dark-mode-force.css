/* Dark Mode Force Override - Loaded Last to Ensure Precedence */

/* Force all cards to use dark theme with maximum specificity */
body.modern-layout.dark-mode .card,
body.modern-layout.dark-mode .card.shadow-sm,
body.modern-layout.dark-mode .card.shadow,
body.modern-layout.dark-mode .card.border,
body.modern-layout.dark-mode .card.mb-4,
body.modern-layout.dark-mode .card.h-100,
body.modern-layout.dark-mode .dashboard-card,
body.modern-layout.dark-mode .stat-card,
body.modern-layout.dark-mode .stat-card.card-interactive,
body.modern-layout.dark-mode .data-card,
body.modern-layout.dark-mode .team-card,
body.modern-layout.dark-mode .match-card {
    background-color: #2d3338 !important;
    border-color: #444 !important;
    color: #e6e6e6 !important;
}

/* Force stat cards specifically */
body.modern-layout.dark-mode .stat-card,
body.modern-layout.dark-mode .stat-card.card-interactive {
    background-color: #2d3338 !important;
    border-color: #444 !important;
    color: #e6e6e6 !important;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.3) !important;
}

/* Force stat card components */
body.modern-layout.dark-mode .stat-card .stat-icon,
body.modern-layout.dark-mode .stat-card .stat-icon i {
    color: #e6e6e6 !important;
}

body.modern-layout.dark-mode .stat-card .stat-label {
    color: #b0b0b0 !important;
}

body.modern-layout.dark-mode .stat-card .stat-value {
    color: #e6e6e6 !important;
}

/* Preserve colored stat values but ensure they're visible */
body.modern-layout.dark-mode .stat-card .stat-value.text-primary {
    color: #3d8bfd !important;
}

body.modern-layout.dark-mode .stat-card .stat-value.text-success {
    color: #198754 !important;
}

body.modern-layout.dark-mode .stat-card .stat-value.text-danger {
    color: #dc3545 !important;
}

body.modern-layout.dark-mode .stat-card .stat-value.text-info {
    color: #0dcaf0 !important;
}

body.modern-layout.dark-mode .stat-card .stat-value.text-warning {
    color: #ffc107 !important;
}

/* Force card bodies */
body.modern-layout.dark-mode .card .card-body,
body.modern-layout.dark-mode .card-body {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
}

/* Force card headers */
body.modern-layout.dark-mode .card .card-header,
body.modern-layout.dark-mode .card-header {
    background-color: #252a30 !important;
    color: #e6e6e6 !important;
    border-bottom-color: #444 !important;
}

/* Force nested cards */
body.modern-layout.dark-mode .row .card,
body.modern-layout.dark-mode .col-xl-8 .card,
body.modern-layout.dark-mode .col-xl-4 .card,
body.modern-layout.dark-mode .col-md-6 .card,
body.modern-layout.dark-mode .col-md-4 .card,
body.modern-layout.dark-mode div[class*="col"] .card {
    background-color: #2d3338 !important;
    border-color: #444 !important;
    color: #e6e6e6 !important;
}

/* Force nested card bodies */
body.modern-layout.dark-mode .row .card-body,
body.modern-layout.dark-mode .col-xl-8 .card-body,
body.modern-layout.dark-mode .col-xl-4 .card-body,
body.modern-layout.dark-mode .col-md-6 .card-body,
body.modern-layout.dark-mode .col-md-4 .card-body,
body.modern-layout.dark-mode div[class*="col"] .card-body {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
}

/* Override Bootstrap utility classes */
body.modern-layout.dark-mode .bg-white,
body.modern-layout.dark-mode .bg-light {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
}

body.modern-layout.dark-mode .text-dark {
    color: #e6e6e6 !important;
}

body.modern-layout.dark-mode .text-muted {
    color: #b0b0b0 !important;
}

/* Force list groups */
body.modern-layout.dark-mode .list-group-item {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
    border-color: #444 !important;
}

body.modern-layout.dark-mode .list-group-item-action:hover {
    background-color: rgba(255, 255, 255, 0.1) !important;
    color: #e6e6e6 !important;
}

/* Force list group flush items (commonly used in cards) */
body.modern-layout.dark-mode .list-group-flush .list-group-item {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
    border-color: #444 !important;
}

body.modern-layout.dark-mode .list-group-flush .list-group-item-action {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
}

body.modern-layout.dark-mode .list-group-flush .list-group-item-action:hover,
body.modern-layout.dark-mode .list-group-flush .list-group-item-action:focus {
    background-color: rgba(255, 255, 255, 0.1) !important;
    color: #e6e6e6 !important;
}

/* Force text within list group items */
body.modern-layout.dark-mode .list-group-item .fw-bold,
body.modern-layout.dark-mode .list-group-item .fw-medium {
    color: #e6e6e6 !important;
}

body.modern-layout.dark-mode .list-group-item .text-muted,
body.modern-layout.dark-mode .list-group-item small.text-muted {
    color: #b0b0b0 !important;
}

/* Preserve colored icons within list items */
body.modern-layout.dark-mode .list-group-item .text-primary {
    color: #3d8bfd !important;
}

body.modern-layout.dark-mode .list-group-item .text-success {
    color: #198754 !important;
}

body.modern-layout.dark-mode .list-group-item .text-danger {
    color: #dc3545 !important;
}

body.modern-layout.dark-mode .list-group-item .text-warning {
    color: #ffc107 !important;
}

body.modern-layout.dark-mode .list-group-item .text-info {
    color: #0dcaf0 !important;
}

/* Force alerts */
body.modern-layout.dark-mode .alert {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
    border-color: #444 !important;
}

/* Keep danger alerts visibly 'red' in dark mode but toned down so contrast is comfortable */
body.modern-layout.dark-mode .alert.alert-danger,
html body.dark-mode .alert.alert-danger {
    background-color: rgba(220,53,69,0.12) !important; /* subtle red tint */
    border-color: rgba(220,53,69,0.28) !important;
    color: #ffe8e8 !important;
}

/* Ensure strong text inside danger alerts is readable */
body.modern-layout.dark-mode .alert.alert-danger strong,
html body.dark-mode .alert.alert-danger strong {
    color: #ffffff !important;
}

/* Force badges */
body.modern-layout.dark-mode .badge {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
    border: 1px solid #444 !important;
}

/* Special handling for colored badges to maintain visibility */
body.modern-layout.dark-mode .badge.bg-primary {
    background-color: #3d8bfd !important;
    color: white !important;
    border-color: #3d8bfd !important;
}

body.modern-layout.dark-mode .badge.bg-success {
    background-color: #198754 !important;
    color: white !important;
    border-color: #198754 !important;
}

body.modern-layout.dark-mode .badge.bg-danger {
    background-color: #dc3545 !important;
    color: white !important;
    border-color: #dc3545 !important;
}

body.modern-layout.dark-mode .badge.bg-warning {
    background-color: #ffc107 !important;
    color: #000 !important;
    border-color: #ffc107 !important;
}

body.modern-layout.dark-mode .badge.bg-info {
    background-color: #0dcaf0 !important;
    color: #000 !important;
    border-color: #0dcaf0 !important;
}

/* Force gradient headers to remain visible */
body.modern-layout.dark-mode .card-header.bg-gradient-primary {
    background: linear-gradient(135deg, #3d8bfd 0%, #0056b3 100%) !important;
    color: white !important;
}

body.modern-layout.dark-mode .card-header.bg-gradient-info {
    background: linear-gradient(135deg, #0dcaf0 0%, #0aa2c0 100%) !important;
    color: white !important;
}

/* Force dropdown buttons within gradient headers */
body.modern-layout.dark-mode .card-header.bg-gradient-primary .btn-light,
body.modern-layout.dark-mode .card-header.bg-gradient-info .btn-light {
    background-color: rgba(255, 255, 255, 0.2) !important;
    border-color: rgba(255, 255, 255, 0.3) !important;
    color: white !important;
}

body.modern-layout.dark-mode .card-header.bg-gradient-primary .btn-light:hover,
body.modern-layout.dark-mode .card-header.bg-gradient-info .btn-light:hover {
    background-color: rgba(255, 255, 255, 0.3) !important;
    border-color: rgba(255, 255, 255, 0.4) !important;
    color: white !important;
}

/* Force dropdown menus */
body.modern-layout.dark-mode .dropdown-menu {
    background-color: #2d3338 !important;
    border-color: #444 !important;
    color: #e6e6e6 !important;
}

body.modern-layout.dark-mode .dropdown-item {
    color: #e6e6e6 !important;
    background-color: transparent !important;
}

body.modern-layout.dark-mode .dropdown-item:hover,
body.modern-layout.dark-mode .dropdown-item:focus {
    background-color: rgba(255, 255, 255, 0.1) !important;
    color: #e6e6e6 !important;
}

body.modern-layout.dark-mode .dropdown-divider {
    border-color: #444 !important;
}

/* Override any inline styles that might force white backgrounds */
body.modern-layout.dark-mode [style*="background-color: white"],
body.modern-layout.dark-mode [style*="background-color: #fff"],
body.modern-layout.dark-mode [style*="background-color: #ffffff"],
body.modern-layout.dark-mode [style*="background: white"],
body.modern-layout.dark-mode [style*="background: #fff"],
body.modern-layout.dark-mode [style*="background: #ffffff"] {
    background-color: #2d3338 !important;
    background: #2d3338 !important;
    color: #e6e6e6 !important;
}

body.modern-layout.dark-mode [style*="color: black"],
body.modern-layout.dark-mode [style*="color: #000"],
body.modern-layout.dark-mode [style*="color: #000000"] {
    color: #e6e6e6 !important;
}

/* Ultra-high specificity overrides for problematic elements */
html body.modern-layout.dark-mode .row .col-sm-6 .stat-card,
html body.modern-layout.dark-mode .row .col-lg-3 .stat-card,
html body.modern-layout.dark-mode .row .stat-card.card-interactive,
html body.modern-layout.dark-mode .col-sm-6 .stat-card,
html body.modern-layout.dark-mode .col-lg-3 .stat-card {
    background-color: #2d3338 !important;
    background-image: none !important;
    background: #2d3338 !important;
    border-color: #444 !important;
    color: #e6e6e6 !important;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.3) !important;
}

/* Ultra-high specificity for list group items */
html body.modern-layout.dark-mode .card .card-body .list-group-flush .list-group-item,
html body.modern-layout.dark-mode .card-body .list-group-flush .list-group-item,
html body.modern-layout.dark-mode .list-group-flush .list-group-item {
    background-color: #2d3338 !important;
    background-image: none !important;
    background: #2d3338 !important;
    border-color: #444 !important;
    color: #e6e6e6 !important;
}

/* Force text colors with maximum specificity */
html body.modern-layout.dark-mode .stat-card .stat-icon,
html body.modern-layout.dark-mode .stat-card .stat-icon i {
    color: #e6e6e6 !important;
}

html body.modern-layout.dark-mode .stat-card .stat-label {
    color: #b0b0b0 !important;
}

html body.modern-layout.dark-mode .stat-card .stat-value {
    color: #e6e6e6 !important;
}

html body.modern-layout.dark-mode .list-group-item .fw-bold,
html body.modern-layout.dark-mode .list-group-item span.fw-bold {
    color: #e6e6e6 !important;
}

/* Override any gradient backgrounds on stat cards */
html body.modern-layout.dark-mode .stat-card,
html body.modern-layout.dark-mode .stat-card.card-interactive {
    background: #2d3338 !important;
    background-image: none !important;
    background-color: #2d3338 !important;
    border: 1px solid #444 !important;
    color: #e6e6e6 !important;
}

/* Target stat cards in specific column layouts */
html body.modern-layout.dark-mode .row.mb-4.g-3 .stat-card,
html body.modern-layout.dark-mode div[class*="col-"] .stat-card {
    background: #2d3338 !important;
    background-image: none !important;
    background-color: #2d3338 !important;
    border: 1px solid #444 !important;
    color: #e6e6e6 !important;
    padding: 20px !important;
    border-radius: 8px !important;
}

/* Force hover states to work properly */
html body.modern-layout.dark-mode .stat-card:hover,
html body.modern-layout.dark-mode .stat-card.card-interactive:hover {
    background: #3a4147 !important;
    background-image: none !important;
    background-color: #3a4147 !important;
    transform: translateY(-3px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5) !important;
}

/* Ensure sidebar brand and section labels are white in dark mode */
body.modern-layout.dark-mode #appSidebar .fw-bold,
body.modern-layout.dark-mode #appSidebar .sidebar-brand,
body.modern-layout.dark-mode #appSidebar .section-label,
html body.modern-layout.dark-mode #appSidebar .section-label {
    color: #ffffff !important;
}

/* Ensure sidebar nav links and muted text are visible */
body.modern-layout.dark-mode #appSidebar .nav-link,
body.modern-layout.dark-mode #appSidebar .nav-link .nav-text,
body.modern-layout.dark-mode #appSidebar .nav-link .text-muted {
    color: #e6e6e6 !important;
}

/* Make info alerts follow dark mode for readability */
body.modern-layout.dark-mode .alert.alert-info,
html body.modern-layout.dark-mode .alert.alert-info {
    background-color: #0b3a44 !important;
    border-color: #1f5660 !important;
    color: #d7f7fb !important;
}

body.modern-layout.dark-mode .alert.alert-info i,
html body.modern-layout.dark-mode .alert.alert-info i {
    color: #9feafc !important;
}

/* Shared error page styles (404/500) */
.site-error-hero {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 24px;
    align-items: center;
    padding: 28px;
}

.site-error-panel {
    background: var(--card-bg, #ffffff) !important;
    border: 1px solid var(--bs-border-color, rgba(0,0,0,0.08)) !important;
    border-radius: 12px !important;
    padding: 28px !important;
    color: var(--bs-body-color, #222) !important;
    box-shadow: 0 8px 28px rgba(2,6,23,0.06) !important;
    background-clip: padding-box !important;
    overflow: hidden !important;
}

.site-error-code {
    font-size: 96px !important;
    line-height: 1 !important;
    font-weight: 700 !important;
    margin: 0 0 8px 0 !important;
    color: var(--bs-body-color, #222) !important;
    opacity: 0.95 !important;
}

.site-error-title { font-size: 22px !important; margin-bottom: 8px !important; font-weight:700 !important; }
.site-error-desc { color: var(--bs-secondary, #6c757d) !important; margin-bottom: 14px !important; }
.site-error-actions { display:flex !important; gap:12px !important; flex-wrap:wrap !important; margin-top:12px !important; }
.site-error-illustration { width:220px; max-width:40vw; }

@media (max-width:720px) {
    .site-error-hero { grid-template-columns: 1fr !important; }
    .site-error-illustration { justify-self:center !important; }
    .site-error-code { font-size:72px !important; }
}

/* Responsive scaling rules so the error hero fits the page gracefully */
.site-error-hero {
    /* use fluid padding and gap that scale with viewport width */
    padding: clamp(12px, 2.6vw, 40px) !important;
    gap: clamp(12px, 2vw, 32px) !important;
}

.site-error-panel {
    /* make font sizes scale smoothly between small and large screens */
    font-size: clamp(0.9rem, 1vw + 0.2rem, 1.05rem) !important;
}

.site-error-code {
    /* scale the big numeric code responsively while keeping it prominent */
    font-size: clamp(48px, 9vw, 120px) !important;
}

.site-error-title { font-size: clamp(18px, 2.2vw, 26px) !important; }
.site-error-desc { font-size: clamp(0.9rem, 1vw, 1.05rem) !important; }

/* Ensure actions compress on narrow screens and buttons wrap nicely */
.site-error-actions { gap:8px !important; justify-content:flex-start !important; }
.site-error-actions .btn { min-width:unset !important; }

@media (max-width:480px) {
    .site-error-illustration { display:none !important; }
    .site-error-code { font-size: clamp(42px, 14vw, 78px) !important; }
    .site-error-panel { padding: 16px !important; }
}

body.modern-layout.dark-mode .alert.alert-info strong,
html body.modern-layout.dark-mode .alert.alert-info strong {
    color: #ffffff !important;
}

body.modern-layout.dark-mode .alert.alert-info a,
html body.modern-layout.dark-mode .alert.alert-info a {
    color: #cdefff !important;
    text-decoration: underline !important;
}

/* Modern semi-transparent card surfaces for a darker, glassy look */
html body.modern-layout.dark-mode .card,
html body.modern-layout.dark-mode .card .card-body,
body.modern-layout.dark-mode .dashboard-card,
body.modern-layout.dark-mode .stat-card,
body.modern-layout.dark-mode .stat-card.card-interactive,
body.modern-layout.dark-mode .data-card,
body.modern-layout.dark-mode .team-card,
body.modern-layout.dark-mode .match-card,
body.modern-layout.dark-mode .list-group-item,
body.modern-layout.dark-mode .dropdown-menu,
body.modern-layout.dark-mode .badge {
    /* slightly darker, semi-transparent surface */
    /* slightly lighter, neutral glass surface so cards sit above the background (no blue tint) */
    background-color: rgba(24, 24, 26, 0.78) !important;
    /* subtle glass blur (works on modern browsers) */
    backdrop-filter: blur(3px) !important;
    -webkit-backdrop-filter: blur(3px) !important;
    /* use a neutral darker border to avoid faint light seams at rounded corners */
    border: 1px solid rgba(0,0,0,0.5) !important;
    /* ensure background does not show seams at the rounded corners */
    background-clip: padding-box !important;
    overflow: hidden !important;
    box-shadow: 0 2px 6px rgba(0,0,0,0.45) !important;
    color: #e6e6e6 !important;
}

/* Card headers slightly darker for contrast and stronger separation */
html body.modern-layout.dark-mode .card-header,
body.modern-layout.dark-mode .card .card-header {
    background-color: rgba(22, 22, 24, 0.76) !important;
    border-bottom-color: rgba(0,0,0,0.45) !important;
    color: #e6e6e6 !important;
}

/* Hover state: lift the surface subtly by brightening background slightly */
html body.modern-layout.dark-mode .card:hover,
html body.modern-layout.dark-mode .stat-card:hover,
html body.modern-layout.dark-mode .list-group-item:hover,
html body.modern-layout.dark-mode .dropdown-item:hover {
    background-color: rgba(30, 30, 32, 0.82) !important;
    transform: translateY(-2px) !important;
}

/* Gradient header accents are preserved (no glass) - no override here so gradients remain intact */

/* Mirror the modern-layout rules for plain .dark-mode body classes so both variants are covered */
html body.dark-mode .card,
html body.dark-mode .card .card-body,
body.dark-mode .dashboard-card,
body.dark-mode .stat-card,
body.dark-mode .stat-card.card-interactive,
body.dark-mode .data-card,
body.dark-mode .team-card,
body.dark-mode .match-card,
body.dark-mode .list-group-item,
body.dark-mode .dropdown-menu,
body.dark-mode .badge {
    background-color: rgba(24, 24, 26, 0.78) !important;
    backdrop-filter: blur(3px) !important;
    -webkit-backdrop-filter: blur(3px) !important;
    border: 1px solid rgba(0,0,0,0.5) !important;
    background-clip: padding-box !important;
    overflow: hidden !important;
    border-color: rgba(255, 255, 255, 0.04) !important;
    box-shadow: 0 1px 0 rgba(0,0,0,0.35) !important;
    color: #e6e6e6 !important;
}

html body.dark-mode .card-header,
body.dark-mode .card .card-header {
    background-color: rgba(22, 22, 24, 0.76) !important;
    border-bottom-color: rgba(0,0,0,0.45) !important;
    color: #e6e6e6 !important;
}

html body.dark-mode .card:hover,
html body.dark-mode .stat-card:hover,
html body.dark-mode .list-group-item:hover,
html body.dark-mode .dropdown-item:hover {
    background-color: rgba(30, 30, 32, 0.82) !important;
    transform: translateY(-2px) !important;
}

/* Gradient header accents are preserved for plain .dark-mode as well */

/* Final override: highest specificity and !important to ensure visual effect */
html body.modern-layout.dark-mode .card, html body.dark-mode .card,
html body.modern-layout.dark-mode .card .card-body, html body.dark-mode .card .card-body,
html body.modern-layout.dark-mode .widget-view-card, html body.dark-mode .widget-view-card,
html body.modern-layout.dark-mode .widget-view-card .card-body, html body.dark-mode .widget-view-card .card-body {
    background-image: none !important;
    background: rgba(10,12,15,0.62) !important;
    background-color: rgba(10,12,15,0.62) !important;
    border-color: rgba(255,255,255,0.04) !important;
    box-shadow: 0 1px 0 rgba(0,0,0,0.35) !important;
    color: #e6e6e6 !important;
}

/* Explicit exception: team selection modal should be solid, high-contrast dark in dark mode */
html body.modern-layout.dark-mode #teamSelectionModal .modal-content,
html body.dark-mode #teamSelectionModal .modal-content,
html body.modern-layout.dark-mode #teamSelectionModal .list-group-item,
html body.dark-mode #teamSelectionModal .list-group-item,
html body.modern-layout.dark-mode #teamSelectionModal .team-selection-item,
html body.dark-mode #teamSelectionModal .team-selection-item {
    /* Use a solid dark card inside dark mode but ensure full opacity and readable text */
    background-color: #2d3338 !important;
    background-image: none !important;
    background: #2d3338 !important;
    color: #e6e6e6 !important;
    border: 1px solid #444 !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.35) !important;
    /* Ensure no glass blur so items don't appear faded */
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    opacity: 1 !important;
}

/* Ensure general modals (including the Wipe DB modal) use dark surfaces in dark mode */
html body.modern-layout.dark-mode .modal-content,
html body.dark-mode .modal-content {
    background-color: #2d3338 !important;
    color: #e6e6e6 !important;
    border-color: #444 !important;
    box-shadow: 0 6px 18px rgba(0,0,0,0.6) !important;
}

/* Specific tuning for the wipe database modal so the danger alert isn't a bright translucent pink */
html body.modern-layout.dark-mode #wipeDbModal .modal-content,
html body.dark-mode #wipeDbModal .modal-content {
    background-color: #2b2f33 !important;
    border: 1px solid rgba(255,255,255,0.04) !important;
}

/* Make the modal header (bg-danger) slightly darker in dark mode so it reads well */
html body.modern-layout.dark-mode #wipeDbModal .modal-header.bg-danger,
html body.dark-mode #wipeDbModal .modal-header.bg-danger {
    background-color: #b03a3a !important; /* darker red for header */
    color: #ffffff !important;
}

/* Danger alert inside the wipe modal: use a toned, low-alpha red on top of the dark modal surface
   and ensure all inner text, lists and form labels are readable */
html body.modern-layout.dark-mode #wipeDbModal .alert.alert-danger,
html body.dark-mode #wipeDbModal .alert.alert-danger {
    background-color: rgba(220,53,69,0.08) !important; /* subtle red tint */
    border-color: rgba(220,53,69,0.22) !important;
    color: #ffffff !important;
}

html body.modern-layout.dark-mode #wipeDbModal .alert.alert-danger p,
html body.dark-mode #wipeDbModal .alert.alert-danger p,
html body.modern-layout.dark-mode #wipeDbModal .alert.alert-danger ul,
html body.dark-mode #wipeDbModal .alert.alert-danger ul,
html body.modern-layout.dark-mode #wipeDbModal .alert.alert-danger li,
html body.dark-mode #wipeDbModal .alert.alert-danger li {
    color: #e6e6e6 !important;
}

/* Checkbox label and small text in the modal should be clear */
html body.modern-layout.dark-mode #wipeDbModal .form-check-label,
html body.dark-mode #wipeDbModal .form-check-label,
html body.modern-layout.dark-mode #wipeDbModal .small,
html body.dark-mode #wipeDbModal .small {
    color: #e6e6e6 !important;
}

/* Ensure buttons in the modal use visible contrast on dark surfaces */
html body.modern-layout.dark-mode #wipeDbModal .btn-secondary {
    background-color: #6c757d !important;
    color: #fff !important;
    border-color: rgba(255,255,255,0.04) !important;
}

html body.modern-layout.dark-mode #wipeDbModal .btn-danger {
    background-color: #c94b4b !important; /* slightly muted danger so it doesn't glare */
    color: #fff !important;
    border-color: rgba(0,0,0,0.2) !important;
}

/* Muted/smaller text inside the modal should be visible */
html body.modern-layout.dark-mode #teamSelectionModal .small.text-muted,
html body.dark-mode #teamSelectionModal .small.text-muted {
    color: #b0b0b0 !important;
    opacity: 1 !important;
}

/* Ensure the modal header retains its blue style and is readable */
html body.modern-layout.dark-mode #teamSelectionModal .modal-header.bg-primary,
html body.dark-mode #teamSelectionModal .modal-header.bg-primary {
    background-color: #1976d2 !important;
    color: #fff !important;
}

/* Hover states inside the modal should be a slightly lighter dark */
html body.modern-layout.dark-mode #teamSelectionModal .list-group-item:hover,
html body.dark-mode #teamSelectionModal .list-group-item:hover {
    background-color: #3a4147 !important;
}

/* Use spaced, rounded item cards inside the team selection modal in dark mode
   so list rows don't look like a continuous set of thin dividers. These rules
   intentionally override the general list-group styles above for the modal. */
html body.modern-layout.dark-mode #teamSelectionModal .list-group-item,
html body.dark-mode #teamSelectionModal .list-group-item,
html body.modern-layout.dark-mode #teamSelectionModal .team-selection-item,
html body.dark-mode #teamSelectionModal .team-selection-item {
    border-radius: 0.5rem !important;
    margin: 0.45rem 0 !important; /* vertical gap between items */
    padding: 0.85rem 0.9rem !important; /* comfortable tappable area (increased vertical padding) */
    background-clip: padding-box !important;
    box-shadow: none !important;
    /* subtle framed card look per item rather than a full-width divider */
    border: 1px solid rgba(255,255,255,0.06) !important;
    background-color: rgba(45,51,56,1) !important; /* solid dark surface */
    min-height: 56px !important; /* ensure enough vertical room for two-line content */
    line-height: 1.2 !important;
}

/* Improve line-height so text doesn't look clipped */
html body.modern-layout.dark-mode #teamSelectionModal .list-group-item .fw-bold,
html body.dark-mode #teamSelectionModal .list-group-item .fw-bold {
    line-height: 1.1 !important;
}

/* Ensure the left and right columns align (prevent wrapping into badge area) */
html body.modern-layout.dark-mode #teamSelectionModal .team-selection-item > div:first-child {
    flex: 1 1 auto !important;
    min-width: 0 !important;
}
html body.modern-layout.dark-mode #teamSelectionModal .team-selection-item > .text-end {
    flex: 0 0 auto !important;
    margin-left: 8px !important;
}

/* Also force any inline-card background overrides to use the glass color in dark mode */
html body.modern-layout.dark-mode [style*="background-color:"], html body.dark-mode [style*="background-color:"] {
    color: inherit !important;
}

/* Inputs, selects, and search fields - slightly lighter surfaces for contrast */
html body.modern-layout.dark-mode .form-control,
html body.dark-mode .form-control,
html body.modern-layout.dark-mode .form-select,
html body.dark-mode .form-select,
html body.modern-layout.dark-mode .select2-container--default .select2-selection--single,
html body.dark-mode .select2-container--default .select2-selection--single {
    background-color: rgba(255,255,255,0.03) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
    box-shadow: none !important;
}

html body.modern-layout.dark-mode .select2-container--default .select2-selection--single .select2-selection__rendered,
html body.dark-mode .select2-container--default .select2-selection--single .select2-selection__rendered {
    color: #e6e6e6 !important;
}

/* Select2 dropdown background and border */
html body.modern-layout.dark-mode .select2-container--default .select2-dropdown,
html body.dark-mode .select2-container--default .select2-dropdown {
    background-color: rgba(10,12,15,0.82) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

/* Buttons and interactive controls - ensure outlines and counters are visible in dark mode */
html body.modern-layout.dark-mode .btn,
html body.dark-mode .btn {
    background-color: rgba(255,255,255,0.02) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

html body.modern-layout.dark-mode .btn-outline-primary,
html body.modern-layout.dark-mode .btn-outline-secondary,
html body.modern-layout.dark-mode .btn-outline-success,
html body.modern-layout.dark-mode .btn-outline-danger,
html body.modern-layout.dark-mode .btn-outline-info,
html body.dark-mode .btn-outline-primary,
html body.dark-mode .btn-outline-secondary,
html body.dark-mode .btn-outline-success,
html body.dark-mode .btn-outline-danger,
html body.dark-mode .btn-outline-info {
    background-color: transparent !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

/* Make checked/selected outline buttons clearly visible in dark mode */
html body.modern-layout.dark-mode .btn-check:checked + .btn-outline-danger,
html body.dark-mode .btn-check:checked + .btn-outline-danger {
    color: #fff !important;
    background-color: rgba(var(--bs-danger-rgb,220,53,69), 0.26) !important;
    border-color: rgba(var(--bs-danger-rgb,220,53,69), 0.44) !important;
    box-shadow: 0 0 0 0.18rem rgba(var(--bs-danger-rgb,220,53,69), 0.22) !important;
}

html body.modern-layout.dark-mode .btn-check:checked + .btn-outline-primary,
html body.dark-mode .btn-check:checked + .btn-outline-primary {
    color: #fff !important;
    background-color: rgba(var(--bs-primary-rgb,13,110,253), 0.26) !important;
    border-color: rgba(var(--bs-primary-rgb,13,110,253), 0.44) !important;
    box-shadow: 0 0 0 0.18rem rgba(var(--bs-primary-rgb,13,110,253), 0.22) !important;
}

html body.modern-layout.dark-mode .btn-check:checked + .btn-outline-secondary,
html body.dark-mode .btn-check:checked + .btn-outline-secondary {
    color: #fff !important;
    background-color: rgba(255,255,255,0.12) !important;
    border-color: rgba(255,255,255,0.22) !important;
    box-shadow: 0 0 0 0.16rem rgba(255,255,255,0.12) !important;
}

/* Fallback for any other outline buttons */
html body.modern-layout.dark-mode .btn-check:checked + .btn,
html body.dark-mode .btn-check:checked + .btn {
    color: #fff !important;
    background-color: rgba(255,255,255,0.12) !important;
    border-color: rgba(255,255,255,0.22) !important;
    box-shadow: 0 0 0 0.16rem rgba(255,255,255,0.12) !important;
}

html body.modern-layout.dark-mode .btn-counter,
html body.dark-mode .btn-counter {
    background-color: rgba(255,255,255,0.02) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

html body.modern-layout.dark-mode .counter-container .counter-input,
html body.dark-mode .counter-container .counter-input,
html body.modern-layout.dark-mode input.counter-input,
html body.dark-mode input.counter-input {
    background-color: rgba(255,255,255,0.03) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

html body.modern-layout.dark-mode textarea.form-control,
html body.dark-mode textarea.form-control {
    background-color: rgba(255,255,255,0.03) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

html body.modern-layout.dark-mode .form-control::placeholder,
html body.dark-mode .form-control::placeholder {
    color: rgba(230,230,230,0.6) !important;
}

/* Make chart canvases' container adopt transparent/dark surface for legibility */
html body.modern-layout.dark-mode canvas,
html body.dark-mode canvas,
html.dark-mode canvas {
    background-color: transparent !important;
}

/* Constrain tutorial preview canvases so they don't expand the page vertically */
#analyticsPreview canvas,
#analyticsPreviewPanel canvas,
.demo-preview canvas,
.sample-chart {
    max-height: 360px !important;
    height: 180px !important;
    width: 100% !important;
    display: block !important;
}

/* Also limit the preview container to avoid runaway expansion */
.demo-preview {
    max-height: 420px !important;
    overflow: auto !important;
}

/* Tutorial preview specific overrides: ensure demo frames, preview forms and controls look dark */
html body.modern-layout.dark-mode .demo-frame,
html body.dark-mode .demo-frame,
html.dark-mode .demo-frame,
html body.modern-layout.dark-mode .demo-preview,
html body.dark-mode .demo-preview,
html.dark-mode .demo-preview {
    background-color: #262a2d !important;
    border-color: #3b3f44 !important;
    color: #e6e6e6 !important;
}

/* Preview placeholders and small help text */
html body.modern-layout.dark-mode .demo-preview .preview-placeholder,
html body.dark-mode .demo-preview .preview-placeholder,
html.dark-mode .demo-preview .preview-placeholder {
    color: rgba(230,230,230,0.65) !important;
}

/* Scope form controls inside demo frames specifically to ensure high specificity */
html body.modern-layout.dark-mode .demo-preview .form-control,
html body.dark-mode .demo-preview .form-control,
html.dark-mode .demo-preview .form-control,
html body.modern-layout.dark-mode .demo-preview .form-select,
html body.dark-mode .demo-preview .form-select,
html.dark-mode .demo-preview .form-select {
    background-color: rgba(255,255,255,0.03) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

/* Buttons inside previews */
html body.modern-layout.dark-mode .demo-preview .btn,
html body.dark-mode .demo-preview .btn,
html.dark-mode .demo-preview .btn {
    background-color: rgba(255,255,255,0.02) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

/* Counter widgets in previews */
html body.modern-layout.dark-mode .demo-preview .counter-container .btn-counter,
html body.dark-mode .demo-preview .counter-container .btn-counter,
html.dark-mode .demo-preview .counter-container .btn-counter {
    background-color: rgba(255,255,255,0.02) !important;
    border-color: rgba(255,255,255,0.06) !important;
    color: #e6e6e6 !important;
}

/* Force any inline white backgrounds inside demo frames to be darkened */
html body.modern-layout.dark-mode .demo-preview [style*="background-color:"],
html body.dark-mode .demo-preview [style*="background-color:"],
html.dark-mode .demo-preview [style*="background-color:"] {
    background-color: rgba(255,255,255,0.02) !important;
    color: #e6e6e6 !important;
}

/* Tutorial highlight helper */
.tutorial-highlight {
    outline: 3px solid rgba(255,193,7,0.15);
    box-shadow: 0 0 0 3px rgba(255,193,7,0.06);
    transition: box-shadow 0.25s ease, outline 0.25s ease;
}

/* Final safety: ensure team selection modal styling is preserved as intended */
html body.modern-layout.dark-mode #teamSelectionModal .modal-content,
html body.dark-mode #teamSelectionModal .modal-content,
html body.modern-layout.dark-mode #teamSelectionModal .modal-body,
html body.dark-mode #teamSelectionModal .modal-body {
    background: #2d3338 !important;
    background-color: #2d3338 !important;
    background-image: none !important;
    color: #e6e6e6 !important;
    border: 1px solid #444 !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.45) !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    opacity: 1 !important;
}

/* Ensure the team selection modal header and footer remain visible by
   constraining the dialog to the viewport and making the body scrollable. */
html body.modern-layout.dark-mode #teamSelectionModal .modal-dialog,
html body.dark-mode #teamSelectionModal .modal-dialog {
    /* leave a small margin from viewport top/bottom */
    max-height: calc(100vh - 48px) !important;
    margin: 24px auto !important;
}

html body.modern-layout.dark-mode #teamSelectionModal .modal-content,
html body.dark-mode #teamSelectionModal .modal-content {
    display: flex !important;
    flex-direction: column !important;
    max-height: calc(100vh - 48px) !important;
}

html body.modern-layout.dark-mode #teamSelectionModal .modal-body,
html body.dark-mode #teamSelectionModal .modal-body {
    overflow-y: auto !important;
    flex: 1 1 auto !important;
}

html body.modern-layout.dark-mode #teamSelectionModal .modal-header,
html body.dark-mode #teamSelectionModal .modal-header,
html body.modern-layout.dark-mode #teamSelectionModal .modal-footer,
html body.dark-mode #teamSelectionModal .modal-footer {
    flex: 0 0 auto !important;
}

/* Popovers and tooltips should look dark and be legible in dark mode */
html body.modern-layout.dark-mode .popover,
html body.dark-mode .popover,
html html.dark-mode .popover {
    background-color: rgba(10,12,15,0.95) !important;
    color: #e6e6e6 !important;
    border-color: rgba(255,255,255,0.04) !important;
}
html body.modern-layout.dark-mode .popover .popover-header,
html body.dark-mode .popover .popover-header,
html html.dark-mode .popover .popover-header {
    background-color: transparent !important;
    border-bottom-color: rgba(255,255,255,0.06) !important;
    color: #ffffff !important;
}
html body.modern-layout.dark-mode .popover .popover-body,
html body.dark-mode .popover .popover-body,
html html.dark-mode .popover .popover-body { color: #e6e6e6 !important; }

/* Tooltips (tiny hover labels) */
html body.modern-layout.dark-mode .tooltip-inner,
html body.dark-mode .tooltip-inner,
html html.dark-mode .tooltip-inner {
    background-color: rgba(6,6,6,0.95) !important;
    color: #e6e6e6 !important;
    border-radius: 6px !important;
}

/* Toasts */
html body.modern-layout.dark-mode .toast,
html body.dark-mode .toast,
html html.dark-mode .toast {
    background-color: rgba(24,24,26,0.9) !important;
    color: #e6e6e6 !important;
    border-color: rgba(255,255,255,0.04) !important;
}
html body.modern-layout.dark-mode .toast .toast-header,
html body.dark-mode .toast .toast-header { background: transparent !important; color: #e6e6e6 !important; }

/* Tables should be readable in dark mode */
html body.modern-layout.dark-mode table.table,
html body.dark-mode table.table,
html html.dark-mode table.table {
    color: #e6e6e6 !important;
}
html body.modern-layout.dark-mode table.table thead th,
html body.dark-mode table.table thead th { background-color: rgba(255,255,255,0.03) !important; color: #e6e6e6 !important; border-color: rgba(255,255,255,0.06) !important; }
html body.modern-layout.dark-mode table.table.table-striped tbody tr:nth-of-type(odd),
html body.dark-mode table.table.table-striped tbody tr:nth-of-type(odd) { background-color: rgba(255,255,255,0.02) !important; }

/* Code and pre elements */
html body.modern-layout.dark-mode pre,
html body.dark-mode pre,
html html.dark-mode pre,
html body.modern-layout.dark-mode code,
html body.dark-mode code,
html html.dark-mode code {
    background-color: rgba(0,0,0,0.6) !important;
    color: #e6e6e6 !important;
    border-radius: 6px !important;
    padding: 0.25rem 0.4rem !important;
}

/* Datatable pagination and controls contrast fixes */
html body.modern-layout.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button,
html body.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button {
    background-color: rgba(255,255,255,0.03) !important;
    color: #e6e6e6 !important;
    border: 1px solid rgba(255,255,255,0.04) !important;
}

/* Safety: ensure popovers are darker than surrounding card backgrounds */
html body.modern-layout.dark-mode .popover { box-shadow: 0 8px 24px rgba(0,0,0,0.6) !important; }


/* Small-screen tweak: increase top/bottom margin if needed */
@media (max-height: 640px) {
    html body.modern-layout.dark-mode #teamSelectionModal .modal-dialog,
    html body.dark-mode #teamSelectionModal .modal-dialog {
        max-height: calc(100vh - 32px) !important;
        margin: 16px auto !important;
    }
}

/* Wider modal layout in dark mode to match light-mode sizing */
html body.modern-layout.dark-mode #teamSelectionModal .modal-dialog,
html body.dark-mode #teamSelectionModal .modal-dialog {
    max-width: 900px !important;
    width: 92% !important;
}

html body.modern-layout.dark-mode #teamSelectionModal .modal-content,
html body.dark-mode #teamSelectionModal .modal-content {
    padding: 0 !important;
}

html body.modern-layout.dark-mode #teamSelectionModal .modal-body,
html body.dark-mode #teamSelectionModal .modal-body {
    padding: 1rem 1.25rem !important;
}

/* Allow list to occupy more horizontal space for names and scores */
html body.modern-layout.dark-mode #teamSelectionModal #teamSelectionList,
html body.dark-mode #teamSelectionModal #teamSelectionList {
    max-height: 640px !important;
}

/* Responsive adjustments */
@media (min-width: 1200px) {
    html body.modern-layout.dark-mode #teamSelectionModal .modal-dialog,
    html body.dark-mode #teamSelectionModal .modal-dialog {
        max-width: 1200px !important;
        width: 72% !important;
    }
}

@media (min-width: 1600px) {
    html body.modern-layout.dark-mode #teamSelectionModal .modal-dialog,
    html body.dark-mode #teamSelectionModal .modal-dialog {
        max-width: 1400px !important;
        width: 58% !important;
    }
}

/* Rounded corners for modal and list edges */
html body.modern-layout.dark-mode #teamSelectionModal .modal-content,
html body.dark-mode #teamSelectionModal .modal-content {
    border-radius: 12px !important;
    overflow: hidden !important;
}

/* Round the top corners of the first list item and bottom corners of the last item */
html body.modern-layout.dark-mode #teamSelectionModal .list-group-item:first-child,
html body.dark-mode #teamSelectionModal .list-group-item:first-child {
    border-top-left-radius: 0 !important; /* header handles rounding */
    border-top-right-radius: 0 !important;
}

html body.modern-layout.dark-mode #teamSelectionModal .list-group-item:last-child,
html body.dark-mode #teamSelectionModal .list-group-item:last-child {
    border-bottom-left-radius: 12px !important;
    border-bottom-right-radius: 12px !important;
    border-bottom: none !important; /* avoid double border with footer */
}

/* Keep list items visually flat in normal cards (we intentionally exclude
   the team selection modal so modal items can use the spaced, rounded look) */
html body.modern-layout.dark-mode .card .list-group-item,
html body.dark-mode .card .list-group-item {
    border-radius: 0 !important;
}

html body.modern-layout.dark-mode #teamSelectionModal .list-group-item .fw-bold,
html body.dark-mode #teamSelectionModal .list-group-item .fw-bold {
    color: #e6e6e6 !important;
}

html body.modern-layout.dark-mode #teamSelectionModal .list-group-item .text-primary,
html body.dark-mode #teamSelectionModal .list-group-item .text-primary {
    color: #3d8bfd !important;
}

/* Match the search input wrapper contrast to the new card surface */
html body.modern-layout.dark-mode .search-input-wrapper,
html body.dark-mode .search-input-wrapper {
    background-color: rgba(255,255,255,0.02) !important;
    border-color: rgba(255,255,255,0.06) !important;
}

/* viewer-controls that used .bg-light should be subtle but discernible in dark mode */
html body.modern-layout.dark-mode .viewer-controls.bg-light,
html body.dark-mode .viewer-controls.bg-light {
    background-color: rgba(255,255,255,0.02) !important;
    border-color: rgba(255,255,255,0.04) !important;
    color: #e6e6e6 !important;
}

/* Ensure horizontal rules and thin dividers are visible */
html body.modern-layout.dark-mode .card hr,
html body.dark-mode .card hr,
html body.modern-layout.dark-mode hr,
html body.dark-mode hr {
    border-top-color: rgba(255,255,255,0.04) !important;
}

/* Placeholder color for inputs in dark mode */
html body.modern-layout.dark-mode ::placeholder,
html body.dark-mode ::placeholder {
    color: #9aa0a6 !important;
    opacity: 1 !important;
}

/* Make nested cards, stat-cards and dashboard cards match the neutral card background
   so small panels inside a larger card don't show a different tint. */
html body.modern-layout.dark-mode .card .card,
html body.dark-mode .card .card,
html body.modern-layout.dark-mode .stat-card,
html body.dark-mode .stat-card,
html body.modern-layout.dark-mode .dashboard-card,
html body.dark-mode .dashboard-card {
    background: var(--card-bg) !important;
    background-color: var(--card-bg) !important;
    border: 1px solid rgba(0,0,0,0.45) !important;
    box-shadow: 0 2px 6px rgba(0,0,0,0.45) !important;
    color: #e6e6e6 !important;
    background-clip: padding-box !important;
    overflow: hidden !important;
}

/* Ensure colored badges (alliances and other semantic badges) retain their
   distinct background colors in dark mode even after the general .badge
   glass/neutral overrides above. These rules use very specific selectors
   and !important so they win against the generic glassy badge styles. */
html body.modern-layout.dark-mode .badge.bg-danger,
html body.dark-mode .badge.bg-danger {
    background-color: #dc3545 !important;
    color: #ffffff !important;
    border-color: #dc3545 !important;
}

html body.modern-layout.dark-mode .badge.bg-primary,
html body.dark-mode .badge.bg-primary {
    background-color: #3d8bfd !important;
    color: #ffffff !important;
    border-color: #3d8bfd !important;
}

html body.modern-layout.dark-mode .badge.bg-success,
html body.dark-mode .badge.bg-success {
    background-color: #198754 !important;
    color: #ffffff !important;
    border-color: #198754 !important;
}

html body.modern-layout.dark-mode .badge.bg-warning,
html body.dark-mode .badge.bg-warning {
    background-color: #ffc107 !important;
    color: #000000 !important;
    border-color: #ffc107 !important;
}

html body.modern-layout.dark-mode .badge.bg-info,
html body.dark-mode .badge.bg-info {
    background-color: #0dcaf0 !important;
    color: #000000 !important;
    border-color: #0dcaf0 !important;
}





